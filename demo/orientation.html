<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
<script>
function lock() {
  document.getElementById("error").innerText = "";

  let elm = document.documentElement;
  if (window.screen.msLockOrientation) {
    document.getElementById("state").innerText = window.screen.msOrientation;
    elm.msRequestFullscreen();
    if (!window.screen.msLockOrientation("portrait-primary")) {
      document.getElementById("error").innerText = "LockOrientation failure";
      return;
    }
    document.getElementById("state").innerText = window.screen.msOrientation;
    return;
  }
  
  document.getElementById("state").innerText = "During LockOrientation: type = " + window.screen.orientation.type;
  elm.requestFullscreen().then(function() {
    window.screen.orientation.lock("portrait").then(function() {
      document.getElementById("state").innerText = "LockOrientation successful: type = " + window.screen.orientation.type;
    }, function(e) {
      document.getElementById("error").innerText = "LockOrientation failure: " + e;
      document.exitFullscreen();
    })
  });
}

function unlock() {
  document.getElementById("error").innerText = "";

  if (window.screen.msUnlockOrientation) {
    document.msExitFullscreen();
    window.screen.msUnlockOrientation();
    document.getElementById("state").innerText = window.screen.msOrientation;
    return;
  }
  if (document.fullscreenElement) {
    document.exitFullscreen().then(function() {
      window.screen.orientation.unlock();
      document.getElementById("state").innerText = window.screen.orientation.type;
    });
  }
}
  
window.screen.orientation.addEventListener('change', e => {
  document.getElementById("state").innerText = "changed event: " + window.screen.orientation.type;
});
</script>
</head>
<body>
  <button onclick="lock()">lock</button>
  <button onclick="unlock()">unlock</button>
  <div id="state"></div>
  <div id="error"></div>
</body>
</html>
